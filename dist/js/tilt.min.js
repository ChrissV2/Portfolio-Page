"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,_toPropertyKey(s.key),s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);i=i.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}var VanillaTilt=function(){var e=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(_classCallCheck(this,i),!(e instanceof Node))throw"Can't initialize VanillaTilt because "+e+" is not a Node.";this.width=null,this.height=null,this.clientWidth=null,this.clientHeight=null,this.left=null,this.top=null,this.gammazero=null,this.betazero=null,this.lastgammazero=null,this.lastbetazero=null,this.transitionTimeout=null,this.updateCall=null,this.event=null,this.updateBind=this.update.bind(this),this.resetBind=this.reset.bind(this),this.element=e,this.settings=this.extendSettings(t),this.reverse=this.settings.reverse?-1:1,this.resetToStart=i.isSettingTrue(this.settings["reset-to-start"]),this.glare=i.isSettingTrue(this.settings.glare),this.glarePrerender=i.isSettingTrue(this.settings["glare-prerender"]),this.fullPageListening=i.isSettingTrue(this.settings["full-page-listening"]),this.gyroscope=i.isSettingTrue(this.settings.gyroscope),this.gyroscopeSamples=this.settings.gyroscopeSamples,this.elementListener=this.getElementListener(),this.glare&&this.prepareGlare(),this.fullPageListening&&this.updateClientSize(),this.addEventListeners(),this.reset(),!1===this.resetToStart&&(this.settings.startX=0,this.settings.startY=0)}return _createClass(i,[{key:"getElementListener",value:function(){if(this.fullPageListening)return window.document;if("string"==typeof this.settings["mouse-event-element"]){var e=document.querySelector(this.settings["mouse-event-element"]);if(e)return e}return this.settings["mouse-event-element"]instanceof Node?this.settings["mouse-event-element"]:this.element}},{key:"addEventListeners",value:function(){this.onMouseEnterBind=this.onMouseEnter.bind(this),this.onMouseMoveBind=this.onMouseMove.bind(this),this.onMouseLeaveBind=this.onMouseLeave.bind(this),this.onWindowResizeBind=this.onWindowResize.bind(this),this.onDeviceOrientationBind=this.onDeviceOrientation.bind(this),this.elementListener.addEventListener("mouseenter",this.onMouseEnterBind),this.elementListener.addEventListener("mouseleave",this.onMouseLeaveBind),this.elementListener.addEventListener("mousemove",this.onMouseMoveBind),(this.glare||this.fullPageListening)&&window.addEventListener("resize",this.onWindowResizeBind),this.gyroscope&&window.addEventListener("deviceorientation",this.onDeviceOrientationBind)}},{key:"removeEventListeners",value:function(){this.elementListener.removeEventListener("mouseenter",this.onMouseEnterBind),this.elementListener.removeEventListener("mouseleave",this.onMouseLeaveBind),this.elementListener.removeEventListener("mousemove",this.onMouseMoveBind),this.gyroscope&&window.removeEventListener("deviceorientation",this.onDeviceOrientationBind),(this.glare||this.fullPageListening)&&window.removeEventListener("resize",this.onWindowResizeBind)}},{key:"destroy",value:function(){clearTimeout(this.transitionTimeout),null!==this.updateCall&&cancelAnimationFrame(this.updateCall),this.element.style.willChange="",this.element.style.transition="",this.element.style.transform="",this.resetGlare(),this.removeEventListeners(),this.element.vanillaTilt=null,delete this.element.vanillaTilt,this.element=null}},{key:"onDeviceOrientation",value:function(e){var t,i;null!==e.gamma&&null!==e.beta&&(this.updateElementPosition(),0<this.gyroscopeSamples&&(this.lastgammazero=this.gammazero,this.lastbetazero=this.betazero,null===this.gammazero?(this.gammazero=e.gamma,this.betazero=e.beta):(this.gammazero=(e.gamma+this.lastgammazero)/2,this.betazero=(e.beta+this.lastbetazero)/2),--this.gyroscopeSamples),i=this.settings.gyroscopeMaxAngleX-this.settings.gyroscopeMinAngleX,t=this.settings.gyroscopeMaxAngleY-this.settings.gyroscopeMinAngleY,i=i/this.width,t=t/this.height,i=(e.gamma-(this.settings.gyroscopeMinAngleX+this.gammazero))/i,e=(e.beta-(this.settings.gyroscopeMinAngleY+this.betazero))/t,null!==this.updateCall&&cancelAnimationFrame(this.updateCall),this.event={clientX:i+this.left,clientY:e+this.top},this.updateCall=requestAnimationFrame(this.updateBind))}},{key:"onMouseEnter",value:function(){this.updateElementPosition(),this.element.style.willChange="transform",this.setTransition()}},{key:"onMouseMove",value:function(e){null!==this.updateCall&&cancelAnimationFrame(this.updateCall),this.event=e,this.updateCall=requestAnimationFrame(this.updateBind)}},{key:"onMouseLeave",value:function(){this.setTransition(),this.settings.reset&&requestAnimationFrame(this.resetBind)}},{key:"reset",value:function(){this.onMouseEnter(),this.fullPageListening?this.event={clientX:(this.settings.startX+this.settings.max)/(2*this.settings.max)*this.clientWidth,clientY:(this.settings.startY+this.settings.max)/(2*this.settings.max)*this.clientHeight}:this.event={clientX:this.left+(this.settings.startX+this.settings.max)/(2*this.settings.max)*this.width,clientY:this.top+(this.settings.startY+this.settings.max)/(2*this.settings.max)*this.height};var e=this.settings.scale;this.settings.scale=1,this.update(),this.settings.scale=e,this.resetGlare()}},{key:"resetGlare",value:function(){this.glare&&(this.glareElement.style.transform="rotate(180deg) translate(-50%, -50%)",this.glareElement.style.opacity="0")}},{key:"getValues",value:function(){var e=this.fullPageListening?(t=this.event.clientX/this.clientWidth,this.event.clientY/this.clientHeight):(t=(this.event.clientX-this.left)/this.width,(this.event.clientY-this.top)/this.height),t=Math.min(Math.max(t,0),1);return e=Math.min(Math.max(e,0),1),{tiltX:(this.reverse*(this.settings.max-t*this.settings.max*2)).toFixed(2),tiltY:(this.reverse*(e*this.settings.max*2-this.settings.max)).toFixed(2),percentageX:100*t,percentageY:100*e,angle:Math.atan2(this.event.clientX-(this.left+this.width/2),-(this.event.clientY-(this.top+this.height/2)))*(180/Math.PI)}}},{key:"updateElementPosition",value:function(){var e=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=e.left,this.top=e.top}},{key:"update",value:function(){var e=this.getValues();this.element.style.transform="perspective("+this.settings.perspective+"px) rotateX("+("x"===this.settings.axis?0:e.tiltY)+"deg) rotateY("+("y"===this.settings.axis?0:e.tiltX)+"deg) scale3d("+this.settings.scale+", "+this.settings.scale+", "+this.settings.scale+")",this.glare&&(this.glareElement.style.transform="rotate(".concat(e.angle,"deg) translate(-50%, -50%)"),this.glareElement.style.opacity="".concat(e.percentageY*this.settings["max-glare"]/100)),this.element.dispatchEvent(new CustomEvent("tiltChange",{detail:e})),this.updateCall=null}},{key:"prepareGlare",value:function(){var e,t;this.glarePrerender||((e=document.createElement("div")).classList.add("js-tilt-glare"),(t=document.createElement("div")).classList.add("js-tilt-glare-inner"),e.appendChild(t),this.element.appendChild(e)),this.glareElementWrapper=this.element.querySelector(".js-tilt-glare"),this.glareElement=this.element.querySelector(".js-tilt-glare-inner"),this.glarePrerender||(Object.assign(this.glareElementWrapper.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden","pointer-events":"none","border-radius":"inherit"}),Object.assign(this.glareElement.style,{position:"absolute",top:"50%",left:"50%","pointer-events":"none","background-image":"linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%)",transform:"rotate(180deg) translate(-50%, -50%)","transform-origin":"0% 0%",opacity:"0"}),this.updateGlareSize())}},{key:"updateGlareSize",value:function(){var e;this.glare&&(e=2*(this.element.offsetWidth>this.element.offsetHeight?this.element.offsetWidth:this.element.offsetHeight),Object.assign(this.glareElement.style,{width:"".concat(e,"px"),height:"".concat(e,"px")}))}},{key:"updateClientSize",value:function(){this.clientWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.clientHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},{key:"onWindowResize",value:function(){this.updateGlareSize(),this.updateClientSize()}},{key:"setTransition",value:function(){var e=this;clearTimeout(this.transitionTimeout),this.element.style.transition=this.settings.speed+"ms "+this.settings.easing,this.glare&&(this.glareElement.style.transition="opacity ".concat(this.settings.speed,"ms ").concat(this.settings.easing)),this.transitionTimeout=setTimeout(function(){e.element.style.transition="",e.glare&&(e.glareElement.style.transition="")},this.settings.speed)}},{key:"extendSettings",value:function(e){var t,i={reverse:!1,max:15,startX:0,startY:0,perspective:1e3,easing:"cubic-bezier(.03,.98,.52,.99)",scale:1,speed:300,transition:!0,axis:null,glare:!1,"max-glare":1,"glare-prerender":!1,"full-page-listening":!1,"mouse-event-element":null,reset:!0,"reset-to-start":!0,gyroscope:!0,gyroscopeMinAngleX:-45,gyroscopeMaxAngleX:45,gyroscopeMinAngleY:-45,gyroscopeMaxAngleY:45,gyroscopeSamples:10},s={};for(t in i)if(t in e)s[t]=e[t];else if(this.element.hasAttribute("data-tilt-"+t)){var n=this.element.getAttribute("data-tilt-"+t);try{s[t]=JSON.parse(n)}catch(e){s[t]=n}}else s[t]=i[t];return s}}],[{key:"isSettingTrue",value:function(e){return""===e||!0===e||1===e}},{key:"init",value:function(e,t){(e=(e=e instanceof Node?[e]:e)instanceof NodeList?[].slice.call(e):e)instanceof Array&&e.forEach(function(e){"vanillaTilt"in e||(e.vanillaTilt=new i(e,t))})}}]),i}();return"undefined"!=typeof document&&(window.VanillaTilt=e).init(document.querySelectorAll("[data-tilt]")),e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRpbHQuanMiXSwibmFtZXMiOlsiVmFuaWxsYVRpbHQiLCJlbGVtZW50Iiwic2V0dGluZ3MiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiTm9kZSIsIndpZHRoIiwiaGVpZ2h0IiwiY2xpZW50V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJ0b3AiLCJ1cGRhdGVDYWxsIiwiZXZlbnQiLCJiZXRhemVybyIsInVwZGF0ZSIsImJpbmQiLCJsYXN0Z2FtbWF6ZXJvIiwicmVzZXQiLCJ0cmFuc2l0aW9uVGltZW91dCIsImV4dGVuZFNldHRpbmdzIiwidXBkYXRlQmluZCIsInJlc2V0QmluZCIsImlzU2V0dGluZ1RydWUiLCJnbGFyZSIsInJldmVyc2UiLCJyZXNldFRvU3RhcnQiLCJneXJvc2NvcGUiLCJneXJvc2NvcGVTYW1wbGVzIiwiZnVsbFBhZ2VMaXN0ZW5pbmciLCJlbGVtZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVycyIsInN0YXJ0WSIsIl9jcmVhdGVDbGFzcyIsIm1vdXNlRXZlbnRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwia2V5IiwidmFsdWUiLCJhZGRFdmVudExpc3RlbmVyIiwib25XaW5kb3dSZXNpemVCaW5kIiwid2luZG93Iiwib25EZXZpY2VPcmllbnRhdGlvbiIsIm9uTW91c2VFbnRlckJpbmQiLCJvbkRldmljZU9yaWVudGF0aW9uQmluZCIsIm9uTW91c2VNb3ZlQmluZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImNsZWFyVGltZW91dCIsInJlc2V0R2xhcmUiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsInZhbmlsbGFUaWx0Iiwic3R5bGUiLCJ3aWxsQ2hhbmdlIiwidHJhbnNpdGlvbiIsInRyYW5zZm9ybSIsInVwZGF0ZUVsZW1lbnRQb3NpdGlvbiIsImRlZ3JlZXNQZXJQaXhlbFkiLCJwb3NYIiwiYmV0YSIsInRvdGFsQW5nbGVYIiwidG90YWxBbmdsZVkiLCJhbmdsZVgiLCJnYW1tYSIsImFuZ2xlWSIsInBvc1kiLCJnYW1tYXplcm8iLCJsYXN0YmV0YXplcm8iLCJneXJvc2NvcGVNYXhBbmdsZVgiLCJneXJvc2NvcGVNaW5BbmdsZVgiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJneXJvc2NvcGVNaW5BbmdsZVkiLCJkZWdyZWVzUGVyUGl4ZWxYIiwib25Nb3VzZU1vdmUiLCJjbGllbnRYIiwiY2xpZW50WSIsIm9uTW91c2VMZWF2ZSIsInNldFRyYW5zaXRpb24iLCJvbk1vdXNlRW50ZXIiLCJiYWNrdXBTY2FsZSIsImdsYXJlRWxlbWVudCIsIm1heCIsIm9wYWNpdHkiLCJsZWZ0Iiwic3RhcnRYIiwiZ2V0VmFsdWVzIiwic2NhbGUiLCJ0aWx0WSIsImFuZ2xlIiwiYXRhbjIiLCJ5IiwieCIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvZmZzZXRXaWR0aCIsIk1hdGgiLCJtaW4iLCJ0aWx0WCIsInRvRml4ZWQiLCJwZXJjZW50YWdlWCIsInBlcmNlbnRhZ2VZIiwiZGlzcGF0Y2hFdmVudCIsIlBJIiwib2Zmc2V0SGVpZ2h0IiwidmFsdWVzIiwianNUaWx0R2xhcmUiLCJjbGFzc0xpc3QiLCJwZXJzcGVjdGl2ZSIsImNyZWF0ZUVsZW1lbnQiLCJqc1RpbHRHbGFyZUlubmVyIiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJnbGFyZUVsZW1lbnRXcmFwcGVyIiwiQ3VzdG9tRXZlbnQiLCJPYmplY3QiLCJhc3NpZ24iLCJnbGFyZVByZXJlbmRlciIsInVwZGF0ZUdsYXJlU2l6ZSIsInBvc2l0aW9uIiwib3ZlcmZsb3ciLCJwb2ludGVyLWV2ZW50cyIsImJvcmRlci1yYWRpdXMiLCJ1cGRhdGVDbGllbnRTaXplIiwiX3RoaXMiLCJnbGFyZVNpemUiLCJjb25jYXQiLCJpbm5lcldpZHRoIiwiZG9jdW1lbnRFbGVtZW50IiwiYm9keSIsImlubmVySGVpZ2h0Iiwic3BlZWQiLCJlYXNpbmciLCJzZXRUaW1lb3V0IiwiZSIsImRlZmF1bHRTZXR0aW5ncyIsInByb3BlcnR5IiwibmV3U2V0dGluZ3MiLCJzZXR0aW5nIiwibWF4LWdsYXJlIiwiZ2xhcmUtcHJlcmVuZGVyIiwiZnVsbC1wYWdlLWxpc3RlbmluZyIsImVsZW1lbnRzIiwiY2FsbCIsImd5cm9zY29wZU1heEFuZ2xlWSIsImhhc0F0dHJpYnV0ZSIsImF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsIkpTT04iLCJwYXJzZSIsIk5vZGVMaXN0Iiwic2xpY2UiLCJBcnJheSIsImZvckVhY2giLCJpbml0IiwicXVlcnlTZWxlY3RvckFsbCJdLCJtYXBwaW5ncyI6IjJqQ0FBQSxJQUFJQSxZQUFlLFdBR2YsSUFPTUEsRUFBVyxXQVBqQixTQUFBQSxFQUFBQyxHQUFBLElBQUFDLEVBQUEsRUFBQUMsVUFBQUMsUUFBQUMsS0FBQUEsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUEsR0FDSixHQURJRyxnQkFBQUMsS0FBQVAsQ0FBQSxFQUNKLEVBQUFDLGFBQUFPLE1BQ0EsS0FBQSx3Q0FBQVAsRUFBQSxrQkFHQU0sS0FBQUUsTUFBQSxLQUVVVCxLQUFBQSxPQUFXLEtBQ2ZPLEtBQUFQLFlBQVlDLEtBQXdCTSxLQUFmTCxhQUFRQyxLQUFLRyxLQUFBQSxLQUFBQSxLQUNoQ0MsS0FBTU4sSUFBTyxLQUliTSxLQUFLRSxVQUFZLEtBQ2pCRixLQUFLRyxTQUFhLEtBQ2xCSCxLQUFLSSxjQUFrQixLQUN2QkosS0FBS0ssYUFBZSxLQUVwQkwsS0FBS00sa0JBQVUsS0FTZk4sS0FBS08sV0FBYSxLQVBsQlAsS0FBQVEsTUFBQSxLQUVBUixLQUFLUyxXQUFlVCxLQUFBVSxPQUFBQyxLQUFBWCxJQUFBLEVBQ3BCQSxLQUFLWSxVQUFhWixLQUFHYSxNQUFJRixLQUFBWCxJQUFBLEVBR3pCQSxLQUFLYyxRQUFBQSxFQUNMZCxLQUFLTyxTQUFhUCxLQUFJZSxlQUFBcEIsQ0FBQSxFQUd0QkssS0FBS2dCLFFBQVVoQixLQUFPTCxTQUFRZ0IsUUFBVSxDQUFBLEVBQUEsRUFDeENY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QSxFQUFBLEVBYUgsTUFWd0IsYUFBcEIsT0FBT3FDLFdBRVRNLE9BQU8zQyxZQUFjQSxHQUtUMkosS0FBS3RILFNBQVN1SCxpQkFBaUIsYUFBYSxDQUFDLEVBR3BENUosQ0FFUCxFQUFFIiwiZmlsZSI6InRpbHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFZhbmlsbGFUaWx0ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVkIGJ5IFNlcmdpdSDImGFuZG9yIChtaWNrdTd6dSkgb24gMS8yNy8yMDE3LlxyXG4gICAgICogT3JpZ2luYWwgaWRlYTogaHR0cHM6Ly9naXRodWIuY29tL2dpanNyb2dlL3RpbHQuanNcclxuICAgICAqIE1JVCBMaWNlbnNlLlxyXG4gICAgICogVmVyc2lvbiAxLjguMVxyXG4gICAgICovXHJcbiAgICBcclxuICAgIGNsYXNzIFZhbmlsbGFUaWx0IHtcclxuICAgICAgY29uc3RydWN0b3IoZWxlbWVudCwgc2V0dGluZ3MgPSB7fSkge1xyXG4gICAgICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBOb2RlKSkge1xyXG4gICAgICAgICAgdGhyb3cgKFwiQ2FuJ3QgaW5pdGlhbGl6ZSBWYW5pbGxhVGlsdCBiZWNhdXNlIFwiICsgZWxlbWVudCArIFwiIGlzIG5vdCBhIE5vZGUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHRoaXMud2lkdGggPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNsaWVudFdpZHRoID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNsaWVudEhlaWdodCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5sZWZ0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRvcCA9IG51bGw7XHJcbiAgICBcclxuICAgICAgICAvLyBmb3IgR3lyb3Njb3BlIHNhbXBsaW5nXHJcbiAgICAgICAgdGhpcy5nYW1tYXplcm8gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYmV0YXplcm8gPSBudWxsO1xyXG4gICAgICAgIHRoaXMubGFzdGdhbW1hemVybyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5sYXN0YmV0YXplcm8gPSBudWxsO1xyXG4gICAgXHJcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uVGltZW91dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy51cGRhdGVDYWxsID0gbnVsbDtcclxuICAgICAgICB0aGlzLmV2ZW50ID0gbnVsbDtcclxuICAgIFxyXG4gICAgICAgIHRoaXMudXBkYXRlQmluZCA9IHRoaXMudXBkYXRlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5yZXNldEJpbmQgPSB0aGlzLnJlc2V0LmJpbmQodGhpcyk7XHJcbiAgICBcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0aGlzLmV4dGVuZFNldHRpbmdzKHNldHRpbmdzKTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMucmV2ZXJzZSA9IHRoaXMuc2V0dGluZ3MucmV2ZXJzZSA/IC0xIDogMTtcclxuICAgICAgICB0aGlzLnJlc2V0VG9TdGFydCA9IFZhbmlsbGFUaWx0LmlzU2V0dGluZ1RydWUodGhpcy5zZXR0aW5nc1tcInJlc2V0LXRvLXN0YXJ0XCJdKTtcclxuICAgICAgICB0aGlzLmdsYXJlID0gVmFuaWxsYVRpbHQuaXNTZXR0aW5nVHJ1ZSh0aGlzLnNldHRpbmdzLmdsYXJlKTtcclxuICAgICAgICB0aGlzLmdsYXJlUHJlcmVuZGVyID0gVmFuaWxsYVRpbHQuaXNTZXR0aW5nVHJ1ZSh0aGlzLnNldHRpbmdzW1wiZ2xhcmUtcHJlcmVuZGVyXCJdKTtcclxuICAgICAgICB0aGlzLmZ1bGxQYWdlTGlzdGVuaW5nID0gVmFuaWxsYVRpbHQuaXNTZXR0aW5nVHJ1ZSh0aGlzLnNldHRpbmdzW1wiZnVsbC1wYWdlLWxpc3RlbmluZ1wiXSk7XHJcbiAgICAgICAgdGhpcy5neXJvc2NvcGUgPSBWYW5pbGxhVGlsdC5pc1NldHRpbmdUcnVlKHRoaXMuc2V0dGluZ3MuZ3lyb3Njb3BlKTtcclxuICAgICAgICB0aGlzLmd5cm9zY29wZVNhbXBsZXMgPSB0aGlzLnNldHRpbmdzLmd5cm9zY29wZVNhbXBsZXM7XHJcbiAgICBcclxuICAgICAgICB0aGlzLmVsZW1lbnRMaXN0ZW5lciA9IHRoaXMuZ2V0RWxlbWVudExpc3RlbmVyKCk7XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5nbGFyZSkge1xyXG4gICAgICAgICAgdGhpcy5wcmVwYXJlR2xhcmUoKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5mdWxsUGFnZUxpc3RlbmluZykge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVDbGllbnRTaXplKCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLnJlc2V0VG9TdGFydCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc3RhcnRYID0gMDtcclxuICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc3RhcnRZID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBzdGF0aWMgaXNTZXR0aW5nVHJ1ZShzZXR0aW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHNldHRpbmcgPT09IFwiXCIgfHwgc2V0dGluZyA9PT0gdHJ1ZSB8fCBzZXR0aW5nID09PSAxO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgLyoqXHJcbiAgICAgICAqIE1ldGhvZCByZXR1cm5zIGVsZW1lbnQgd2hhdCB3aWxsIGJlIGxpc3RlbiBtb3VzZSBldmVudHNcclxuICAgICAgICogQHJldHVybiB7Tm9kZX1cclxuICAgICAgICovXHJcbiAgICAgIGdldEVsZW1lbnRMaXN0ZW5lcigpIHtcclxuICAgICAgICBpZiAodGhpcy5mdWxsUGFnZUxpc3RlbmluZykge1xyXG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5kb2N1bWVudDtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBpZiAodHlwZW9mIHRoaXMuc2V0dGluZ3NbXCJtb3VzZS1ldmVudC1lbGVtZW50XCJdID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICBjb25zdCBtb3VzZUV2ZW50RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5zZXR0aW5nc1tcIm1vdXNlLWV2ZW50LWVsZW1lbnRcIl0pO1xyXG4gICAgXHJcbiAgICAgICAgICBpZiAobW91c2VFdmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1vdXNlRXZlbnRFbGVtZW50O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzW1wibW91c2UtZXZlbnQtZWxlbWVudFwiXSBpbnN0YW5jZW9mIE5vZGUpIHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzW1wibW91c2UtZXZlbnQtZWxlbWVudFwiXTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50O1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgLyoqXHJcbiAgICAgICAqIE1ldGhvZCBzZXQgbGlzdGVuIG1ldGhvZHMgZm9yIHRoaXMuZWxlbWVudExpc3RlbmVyXHJcbiAgICAgICAqIEByZXR1cm4ge05vZGV9XHJcbiAgICAgICAqL1xyXG4gICAgICBhZGRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLm9uTW91c2VFbnRlckJpbmQgPSB0aGlzLm9uTW91c2VFbnRlci5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMub25Nb3VzZU1vdmVCaW5kID0gdGhpcy5vbk1vdXNlTW92ZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMub25Nb3VzZUxlYXZlQmluZCA9IHRoaXMub25Nb3VzZUxlYXZlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbldpbmRvd1Jlc2l6ZUJpbmQgPSB0aGlzLm9uV2luZG93UmVzaXplLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5vbkRldmljZU9yaWVudGF0aW9uQmluZCA9IHRoaXMub25EZXZpY2VPcmllbnRhdGlvbi5iaW5kKHRoaXMpO1xyXG4gICAgXHJcbiAgICAgICAgdGhpcy5lbGVtZW50TGlzdGVuZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgdGhpcy5vbk1vdXNlRW50ZXJCaW5kKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnRMaXN0ZW5lci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCB0aGlzLm9uTW91c2VMZWF2ZUJpbmQpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudExpc3RlbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy5vbk1vdXNlTW92ZUJpbmQpO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKHRoaXMuZ2xhcmUgfHwgdGhpcy5mdWxsUGFnZUxpc3RlbmluZykge1xyXG4gICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5vbldpbmRvd1Jlc2l6ZUJpbmQpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmd5cm9zY29wZSkge1xyXG4gICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJkZXZpY2VvcmllbnRhdGlvblwiLCB0aGlzLm9uRGV2aWNlT3JpZW50YXRpb25CaW5kKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICAvKipcclxuICAgICAgICogTWV0aG9kIHJlbW92ZSBldmVudCBsaXN0ZW5lcnMgZnJvbSBjdXJyZW50IHRoaXMuZWxlbWVudExpc3RlbmVyXHJcbiAgICAgICAqL1xyXG4gICAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnRMaXN0ZW5lci5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCB0aGlzLm9uTW91c2VFbnRlckJpbmQpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudExpc3RlbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIHRoaXMub25Nb3VzZUxlYXZlQmluZCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50TGlzdGVuZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLm9uTW91c2VNb3ZlQmluZCk7XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5neXJvc2NvcGUpIHtcclxuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGV2aWNlb3JpZW50YXRpb25cIiwgdGhpcy5vbkRldmljZU9yaWVudGF0aW9uQmluZCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgaWYgKHRoaXMuZ2xhcmUgfHwgdGhpcy5mdWxsUGFnZUxpc3RlbmluZykge1xyXG4gICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5vbldpbmRvd1Jlc2l6ZUJpbmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudHJhbnNpdGlvblRpbWVvdXQpO1xyXG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZUNhbGwgIT09IG51bGwpIHtcclxuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlQ2FsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLndpbGxDaGFuZ2UgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gXCJcIjtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gXCJcIjtcclxuICAgICAgICB0aGlzLnJlc2V0R2xhcmUoKTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQudmFuaWxsYVRpbHQgPSBudWxsO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmVsZW1lbnQudmFuaWxsYVRpbHQ7XHJcbiAgICBcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgb25EZXZpY2VPcmllbnRhdGlvbihldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudC5nYW1tYSA9PT0gbnVsbCB8fCBldmVudC5iZXRhID09PSBudWxsKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy51cGRhdGVFbGVtZW50UG9zaXRpb24oKTtcclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmd5cm9zY29wZVNhbXBsZXMgPiAwKSB7XHJcbiAgICAgICAgICB0aGlzLmxhc3RnYW1tYXplcm8gPSB0aGlzLmdhbW1hemVybztcclxuICAgICAgICAgIHRoaXMubGFzdGJldGF6ZXJvID0gdGhpcy5iZXRhemVybztcclxuICAgIFxyXG4gICAgICAgICAgaWYgKHRoaXMuZ2FtbWF6ZXJvID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtbWF6ZXJvID0gZXZlbnQuZ2FtbWE7XHJcbiAgICAgICAgICAgIHRoaXMuYmV0YXplcm8gPSBldmVudC5iZXRhO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1tYXplcm8gPSAoZXZlbnQuZ2FtbWEgKyB0aGlzLmxhc3RnYW1tYXplcm8pIC8gMjtcclxuICAgICAgICAgICAgdGhpcy5iZXRhemVybyA9IChldmVudC5iZXRhICsgdGhpcy5sYXN0YmV0YXplcm8pIC8gMjtcclxuICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgdGhpcy5neXJvc2NvcGVTYW1wbGVzIC09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgY29uc3QgdG90YWxBbmdsZVggPSB0aGlzLnNldHRpbmdzLmd5cm9zY29wZU1heEFuZ2xlWCAtIHRoaXMuc2V0dGluZ3MuZ3lyb3Njb3BlTWluQW5nbGVYO1xyXG4gICAgICAgIGNvbnN0IHRvdGFsQW5nbGVZID0gdGhpcy5zZXR0aW5ncy5neXJvc2NvcGVNYXhBbmdsZVkgLSB0aGlzLnNldHRpbmdzLmd5cm9zY29wZU1pbkFuZ2xlWTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IGRlZ3JlZXNQZXJQaXhlbFggPSB0b3RhbEFuZ2xlWCAvIHRoaXMud2lkdGg7XHJcbiAgICAgICAgY29uc3QgZGVncmVlc1BlclBpeGVsWSA9IHRvdGFsQW5nbGVZIC8gdGhpcy5oZWlnaHQ7XHJcbiAgICBcclxuICAgICAgICBjb25zdCBhbmdsZVggPSBldmVudC5nYW1tYSAtICh0aGlzLnNldHRpbmdzLmd5cm9zY29wZU1pbkFuZ2xlWCArIHRoaXMuZ2FtbWF6ZXJvKTtcclxuICAgICAgICBjb25zdCBhbmdsZVkgPSBldmVudC5iZXRhIC0gKHRoaXMuc2V0dGluZ3MuZ3lyb3Njb3BlTWluQW5nbGVZICsgdGhpcy5iZXRhemVybyk7XHJcbiAgICBcclxuICAgICAgICBjb25zdCBwb3NYID0gYW5nbGVYIC8gZGVncmVlc1BlclBpeGVsWDtcclxuICAgICAgICBjb25zdCBwb3NZID0gYW5nbGVZIC8gZGVncmVlc1BlclBpeGVsWTtcclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZUNhbGwgIT09IG51bGwpIHtcclxuICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlQ2FsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5ldmVudCA9IHtcclxuICAgICAgICAgIGNsaWVudFg6IHBvc1ggKyB0aGlzLmxlZnQsXHJcbiAgICAgICAgICBjbGllbnRZOiBwb3NZICsgdGhpcy50b3AsXHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMudXBkYXRlQ2FsbCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZUJpbmQpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgb25Nb3VzZUVudGVyKCkge1xyXG4gICAgICAgIHRoaXMudXBkYXRlRWxlbWVudFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLndpbGxDaGFuZ2UgPSBcInRyYW5zZm9ybVwiO1xyXG4gICAgICAgIHRoaXMuc2V0VHJhbnNpdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgb25Nb3VzZU1vdmUoZXZlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy51cGRhdGVDYWxsICE9PSBudWxsKSB7XHJcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZUNhbGwpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHRoaXMuZXZlbnQgPSBldmVudDtcclxuICAgICAgICB0aGlzLnVwZGF0ZUNhbGwgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGVCaW5kKTtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIG9uTW91c2VMZWF2ZSgpIHtcclxuICAgICAgICB0aGlzLnNldFRyYW5zaXRpb24oKTtcclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnJlc2V0KSB7XHJcbiAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZXNldEJpbmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMub25Nb3VzZUVudGVyKCk7XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5mdWxsUGFnZUxpc3RlbmluZykge1xyXG4gICAgICAgICAgdGhpcy5ldmVudCA9IHtcclxuICAgICAgICAgICAgY2xpZW50WDogKHRoaXMuc2V0dGluZ3Muc3RhcnRYICsgdGhpcy5zZXR0aW5ncy5tYXgpIC8gKDIgKiB0aGlzLnNldHRpbmdzLm1heCkgKiB0aGlzLmNsaWVudFdpZHRoLFxyXG4gICAgICAgICAgICBjbGllbnRZOiAodGhpcy5zZXR0aW5ncy5zdGFydFkgKyB0aGlzLnNldHRpbmdzLm1heCkgLyAoMiAqIHRoaXMuc2V0dGluZ3MubWF4KSAqIHRoaXMuY2xpZW50SGVpZ2h0XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmV2ZW50ID0ge1xyXG4gICAgICAgICAgICBjbGllbnRYOiB0aGlzLmxlZnQgKyAoKHRoaXMuc2V0dGluZ3Muc3RhcnRYICsgdGhpcy5zZXR0aW5ncy5tYXgpIC8gKDIgKiB0aGlzLnNldHRpbmdzLm1heCkgKiB0aGlzLndpZHRoKSxcclxuICAgICAgICAgICAgY2xpZW50WTogdGhpcy50b3AgKyAoKHRoaXMuc2V0dGluZ3Muc3RhcnRZICsgdGhpcy5zZXR0aW5ncy5tYXgpIC8gKDIgKiB0aGlzLnNldHRpbmdzLm1heCkgKiB0aGlzLmhlaWdodClcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgbGV0IGJhY2t1cFNjYWxlID0gdGhpcy5zZXR0aW5ncy5zY2FsZTtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLnNjYWxlID0gMTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3Muc2NhbGUgPSBiYWNrdXBTY2FsZTtcclxuICAgICAgICB0aGlzLnJlc2V0R2xhcmUoKTtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIHJlc2V0R2xhcmUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2xhcmUpIHtcclxuICAgICAgICAgIHRoaXMuZ2xhcmVFbGVtZW50LnN0eWxlLnRyYW5zZm9ybSA9IFwicm90YXRlKDE4MGRlZykgdHJhbnNsYXRlKC01MCUsIC01MCUpXCI7XHJcbiAgICAgICAgICB0aGlzLmdsYXJlRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gXCIwXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgZ2V0VmFsdWVzKCkge1xyXG4gICAgICAgIGxldCB4LCB5O1xyXG4gICAgXHJcbiAgICAgICAgaWYgKHRoaXMuZnVsbFBhZ2VMaXN0ZW5pbmcpIHtcclxuICAgICAgICAgIHggPSB0aGlzLmV2ZW50LmNsaWVudFggLyB0aGlzLmNsaWVudFdpZHRoO1xyXG4gICAgICAgICAgeSA9IHRoaXMuZXZlbnQuY2xpZW50WSAvIHRoaXMuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB4ID0gKHRoaXMuZXZlbnQuY2xpZW50WCAtIHRoaXMubGVmdCkgLyB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgeSA9ICh0aGlzLmV2ZW50LmNsaWVudFkgLSB0aGlzLnRvcCkgLyB0aGlzLmhlaWdodDtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICB4ID0gTWF0aC5taW4oTWF0aC5tYXgoeCwgMCksIDEpO1xyXG4gICAgICAgIHkgPSBNYXRoLm1pbihNYXRoLm1heCh5LCAwKSwgMSk7XHJcbiAgICBcclxuICAgICAgICBsZXQgdGlsdFggPSAodGhpcy5yZXZlcnNlICogKHRoaXMuc2V0dGluZ3MubWF4IC0geCAqIHRoaXMuc2V0dGluZ3MubWF4ICogMikpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgbGV0IHRpbHRZID0gKHRoaXMucmV2ZXJzZSAqICh5ICogdGhpcy5zZXR0aW5ncy5tYXggKiAyIC0gdGhpcy5zZXR0aW5ncy5tYXgpKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgIGxldCBhbmdsZSA9IE1hdGguYXRhbjIodGhpcy5ldmVudC5jbGllbnRYIC0gKHRoaXMubGVmdCArIHRoaXMud2lkdGggLyAyKSwgLSh0aGlzLmV2ZW50LmNsaWVudFkgLSAodGhpcy50b3AgKyB0aGlzLmhlaWdodCAvIDIpKSkgKiAoMTgwIC8gTWF0aC5QSSk7XHJcbiAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgdGlsdFg6IHRpbHRYLFxyXG4gICAgICAgICAgdGlsdFk6IHRpbHRZLFxyXG4gICAgICAgICAgcGVyY2VudGFnZVg6IHggKiAxMDAsXHJcbiAgICAgICAgICBwZXJjZW50YWdlWTogeSAqIDEwMCxcclxuICAgICAgICAgIGFuZ2xlOiBhbmdsZVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICB1cGRhdGVFbGVtZW50UG9zaXRpb24oKSB7XHJcbiAgICAgICAgbGV0IHJlY3QgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICBcclxuICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDtcclxuICAgICAgICB0aGlzLmxlZnQgPSByZWN0LmxlZnQ7XHJcbiAgICAgICAgdGhpcy50b3AgPSByZWN0LnRvcDtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIHVwZGF0ZSgpIHtcclxuICAgICAgICBsZXQgdmFsdWVzID0gdGhpcy5nZXRWYWx1ZXMoKTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBcInBlcnNwZWN0aXZlKFwiICsgdGhpcy5zZXR0aW5ncy5wZXJzcGVjdGl2ZSArIFwicHgpIFwiICtcclxuICAgICAgICAgIFwicm90YXRlWChcIiArICh0aGlzLnNldHRpbmdzLmF4aXMgPT09IFwieFwiID8gMCA6IHZhbHVlcy50aWx0WSkgKyBcImRlZykgXCIgK1xyXG4gICAgICAgICAgXCJyb3RhdGVZKFwiICsgKHRoaXMuc2V0dGluZ3MuYXhpcyA9PT0gXCJ5XCIgPyAwIDogdmFsdWVzLnRpbHRYKSArIFwiZGVnKSBcIiArXHJcbiAgICAgICAgICBcInNjYWxlM2QoXCIgKyB0aGlzLnNldHRpbmdzLnNjYWxlICsgXCIsIFwiICsgdGhpcy5zZXR0aW5ncy5zY2FsZSArIFwiLCBcIiArIHRoaXMuc2V0dGluZ3Muc2NhbGUgKyBcIilcIjtcclxuICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmdsYXJlKSB7XHJcbiAgICAgICAgICB0aGlzLmdsYXJlRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgcm90YXRlKCR7dmFsdWVzLmFuZ2xlfWRlZykgdHJhbnNsYXRlKC01MCUsIC01MCUpYDtcclxuICAgICAgICAgIHRoaXMuZ2xhcmVFbGVtZW50LnN0eWxlLm9wYWNpdHkgPSBgJHt2YWx1ZXMucGVyY2VudGFnZVkgKiB0aGlzLnNldHRpbmdzW1wibWF4LWdsYXJlXCJdIC8gMTAwfWA7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwidGlsdENoYW5nZVwiLCB7XHJcbiAgICAgICAgICBcImRldGFpbFwiOiB2YWx1ZXNcclxuICAgICAgICB9KSk7XHJcbiAgICBcclxuICAgICAgICB0aGlzLnVwZGF0ZUNhbGwgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgLyoqXHJcbiAgICAgICAqIEFwcGVuZHMgdGhlIGdsYXJlIGVsZW1lbnQgKGlmIGdsYXJlUHJlcmVuZGVyIGVxdWFscyBmYWxzZSlcclxuICAgICAgICogYW5kIHNldHMgdGhlIGRlZmF1bHQgc3R5bGVcclxuICAgICAgICovXHJcbiAgICAgIHByZXBhcmVHbGFyZSgpIHtcclxuICAgICAgICAvLyBJZiBvcHRpb24gcHJlLXJlbmRlciBpcyBlbmFibGVkIHdlIGFzc3VtZSBhbGwgaHRtbC9jc3MgaXMgcHJlc2VudCBmb3IgYW4gb3B0aW1hbCBnbGFyZSBlZmZlY3QuXHJcbiAgICAgICAgaWYgKCF0aGlzLmdsYXJlUHJlcmVuZGVyKSB7XHJcbiAgICAgICAgICAvLyBDcmVhdGUgZ2xhcmUgZWxlbWVudFxyXG4gICAgICAgICAgY29uc3QganNUaWx0R2xhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAganNUaWx0R2xhcmUuY2xhc3NMaXN0LmFkZChcImpzLXRpbHQtZ2xhcmVcIik7XHJcbiAgICBcclxuICAgICAgICAgIGNvbnN0IGpzVGlsdEdsYXJlSW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAganNUaWx0R2xhcmVJbm5lci5jbGFzc0xpc3QuYWRkKFwianMtdGlsdC1nbGFyZS1pbm5lclwiKTtcclxuICAgIFxyXG4gICAgICAgICAganNUaWx0R2xhcmUuYXBwZW5kQ2hpbGQoanNUaWx0R2xhcmVJbm5lcik7XHJcbiAgICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoanNUaWx0R2xhcmUpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHRoaXMuZ2xhcmVFbGVtZW50V3JhcHBlciA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmpzLXRpbHQtZ2xhcmVcIik7XHJcbiAgICAgICAgdGhpcy5nbGFyZUVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5qcy10aWx0LWdsYXJlLWlubmVyXCIpO1xyXG4gICAgXHJcbiAgICAgICAgaWYgKHRoaXMuZ2xhcmVQcmVyZW5kZXIpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZ2xhcmVFbGVtZW50V3JhcHBlci5zdHlsZSwge1xyXG4gICAgICAgICAgXCJwb3NpdGlvblwiOiBcImFic29sdXRlXCIsXHJcbiAgICAgICAgICBcInRvcFwiOiBcIjBcIixcclxuICAgICAgICAgIFwibGVmdFwiOiBcIjBcIixcclxuICAgICAgICAgIFwid2lkdGhcIjogXCIxMDAlXCIsXHJcbiAgICAgICAgICBcImhlaWdodFwiOiBcIjEwMCVcIixcclxuICAgICAgICAgIFwib3ZlcmZsb3dcIjogXCJoaWRkZW5cIixcclxuICAgICAgICAgIFwicG9pbnRlci1ldmVudHNcIjogXCJub25lXCIsXHJcbiAgICAgICAgICBcImJvcmRlci1yYWRpdXNcIjogXCJpbmhlcml0XCJcclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5nbGFyZUVsZW1lbnQuc3R5bGUsIHtcclxuICAgICAgICAgIFwicG9zaXRpb25cIjogXCJhYnNvbHV0ZVwiLFxyXG4gICAgICAgICAgXCJ0b3BcIjogXCI1MCVcIixcclxuICAgICAgICAgIFwibGVmdFwiOiBcIjUwJVwiLFxyXG4gICAgICAgICAgXCJwb2ludGVyLWV2ZW50c1wiOiBcIm5vbmVcIixcclxuICAgICAgICAgIFwiYmFja2dyb3VuZC1pbWFnZVwiOiBgbGluZWFyLWdyYWRpZW50KDBkZWcsIHJnYmEoMjU1LDI1NSwyNTUsMCkgMCUsIHJnYmEoMjU1LDI1NSwyNTUsMSkgMTAwJSlgLFxyXG4gICAgICAgICAgXCJ0cmFuc2Zvcm1cIjogXCJyb3RhdGUoMTgwZGVnKSB0cmFuc2xhdGUoLTUwJSwgLTUwJSlcIixcclxuICAgICAgICAgIFwidHJhbnNmb3JtLW9yaWdpblwiOiBcIjAlIDAlXCIsXHJcbiAgICAgICAgICBcIm9wYWNpdHlcIjogXCIwXCJcclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMudXBkYXRlR2xhcmVTaXplKCk7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICB1cGRhdGVHbGFyZVNpemUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2xhcmUpIHtcclxuICAgICAgICAgIGNvbnN0IGdsYXJlU2l6ZSA9ICh0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGggPiB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0ID8gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoIDogdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodCkgKiAyO1xyXG4gICAgXHJcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZ2xhcmVFbGVtZW50LnN0eWxlLCB7XHJcbiAgICAgICAgICAgIFwid2lkdGhcIjogYCR7Z2xhcmVTaXplfXB4YCxcclxuICAgICAgICAgICAgXCJoZWlnaHRcIjogYCR7Z2xhcmVTaXplfXB4YCxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIHVwZGF0ZUNsaWVudFNpemUoKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnRXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoXHJcbiAgICAgICAgICB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGhcclxuICAgICAgICAgIHx8IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7XHJcbiAgICBcclxuICAgICAgICB0aGlzLmNsaWVudEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodFxyXG4gICAgICAgICAgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxyXG4gICAgICAgICAgfHwgZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQ7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBvbldpbmRvd1Jlc2l6ZSgpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUdsYXJlU2l6ZSgpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlQ2xpZW50U2l6ZSgpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgc2V0VHJhbnNpdGlvbigpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50cmFuc2l0aW9uVGltZW91dCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSB0aGlzLnNldHRpbmdzLnNwZWVkICsgXCJtcyBcIiArIHRoaXMuc2V0dGluZ3MuZWFzaW5nO1xyXG4gICAgICAgIGlmICh0aGlzLmdsYXJlKSB0aGlzLmdsYXJlRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gYG9wYWNpdHkgJHt0aGlzLnNldHRpbmdzLnNwZWVkfW1zICR7dGhpcy5zZXR0aW5ncy5lYXNpbmd9YDtcclxuICAgIFxyXG4gICAgICAgIHRoaXMudHJhbnNpdGlvblRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gXCJcIjtcclxuICAgICAgICAgIGlmICh0aGlzLmdsYXJlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2xhcmVFbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSBcIlwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMuc2V0dGluZ3Muc3BlZWQpO1xyXG4gICAgXHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICAvKipcclxuICAgICAgICogTWV0aG9kIHJldHVybiBwYXRjaGVkIHNldHRpbmdzIG9mIGluc3RhbmNlXHJcbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2V0dGluZ3MucmV2ZXJzZSAtIHJldmVyc2UgdGhlIHRpbHQgZGlyZWN0aW9uXHJcbiAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXR0aW5ncy5tYXggLSBtYXggdGlsdCByb3RhdGlvbiAoZGVncmVlcylcclxuICAgICAgICogQHBhcmFtIHtzdGFydFh9IHNldHRpbmdzLnN0YXJ0WCAtIHRoZSBzdGFydGluZyB0aWx0IG9uIHRoZSBYIGF4aXMsIGluIGRlZ3JlZXMuIERlZmF1bHQ6IDBcclxuICAgICAgICogQHBhcmFtIHtzdGFydFl9IHNldHRpbmdzLnN0YXJ0WSAtIHRoZSBzdGFydGluZyB0aWx0IG9uIHRoZSBZIGF4aXMsIGluIGRlZ3JlZXMuIERlZmF1bHQ6IDBcclxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNldHRpbmdzLnBlcnNwZWN0aXZlIC0gVHJhbnNmb3JtIHBlcnNwZWN0aXZlLCB0aGUgbG93ZXIgdGhlIG1vcmUgZXh0cmVtZSB0aGUgdGlsdCBnZXRzXHJcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXR0aW5ncy5lYXNpbmcgLSBFYXNpbmcgb24gZW50ZXIvZXhpdFxyXG4gICAgICAgKiBAcGFyYW0ge251bWJlcn0gc2V0dGluZ3Muc2NhbGUgLSAyID0gMjAwJSwgMS41ID0gMTUwJSwgZXRjLi5cclxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNldHRpbmdzLnNwZWVkIC0gU3BlZWQgb2YgdGhlIGVudGVyL2V4aXQgdHJhbnNpdGlvblxyXG4gICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNldHRpbmdzLnRyYW5zaXRpb24gLSBTZXQgYSB0cmFuc2l0aW9uIG9uIGVudGVyL2V4aXRcclxuICAgICAgICogQHBhcmFtIHtzdHJpbmd8bnVsbH0gc2V0dGluZ3MuYXhpcyAtIFdoYXQgYXhpcyBzaG91bGQgYmUgZW5hYmxlZC4gQ2FuIGJlIFwieFwiIG9yIFwieVwiXHJcbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2V0dGluZ3MuZ2xhcmUgLSBpZiBpdCBzaG91bGQgaGF2ZSBhIFwiZ2xhcmVcIiBlZmZlY3RcclxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNldHRpbmdzLm1heC1nbGFyZSAtIHRoZSBtYXhpbXVtIFwiZ2xhcmVcIiBvcGFjaXR5ICgxID0gMTAwJSwgMC41ID0gNTAlKVxyXG4gICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNldHRpbmdzLmdsYXJlLXByZXJlbmRlciAtIGZhbHNlID0gVmFuaWxsYVRpbHQgY3JlYXRlcyB0aGUgZ2xhcmUgZWxlbWVudHMgZm9yIHlvdSwgb3RoZXJ3aXNlXHJcbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2V0dGluZ3MuZnVsbC1wYWdlLWxpc3RlbmluZyAtIElmIHRydWUsIHBhcmFsbGF4IGVmZmVjdCB3aWxsIGxpc3RlbiB0byBtb3VzZSBtb3ZlIGV2ZW50cyBvbiB0aGUgd2hvbGUgZG9jdW1lbnQsIG5vdCBvbmx5IHRoZSBzZWxlY3RlZCBlbGVtZW50XHJcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gc2V0dGluZ3MubW91c2UtZXZlbnQtZWxlbWVudCAtIFN0cmluZyBzZWxlY3RvciBvciBsaW5rIHRvIEhUTUwtZWxlbWVudCB3aGF0IHdpbGwgYmUgbGlzdGVuIG1vdXNlIGV2ZW50c1xyXG4gICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNldHRpbmdzLnJlc2V0IC0gZmFsc2UgPSBJZiB0aGUgdGlsdCBlZmZlY3QgaGFzIHRvIGJlIHJlc2V0IG9uIGV4aXRcclxuICAgICAgICogQHBhcmFtIHtib29sZWFufSBzZXR0aW5ncy5yZXNldC10by1zdGFydCAtIHRydWUgPSBPbiByZXNldCBldmVudCAobW91c2UgbGVhdmUpIHdpbGwgcmV0dXJuIHRvIGluaXRpYWwgc3RhcnQgYW5nbGUgKGlmIHN0YXJ0WCBvciBzdGFydFkgaXMgc2V0KVxyXG4gICAgICAgKiBAcGFyYW0ge2d5cm9zY29wZX0gc2V0dGluZ3MuZ3lyb3Njb3BlIC0gRW5hYmxlIHRpbHRpbmcgYnkgZGV2aWNlb3JpZW50YXRpb24gZXZlbnRzXHJcbiAgICAgICAqIEBwYXJhbSB7Z3lyb3Njb3BlU2Vuc2l0aXZpdHl9IHNldHRpbmdzLmd5cm9zY29wZVNlbnNpdGl2aXR5IC0gQmV0d2VlbiAwIGFuZCAxIC0gVGhlIGFuZ2xlIGF0IHdoaWNoIG1heCB0aWx0IHBvc2l0aW9uIGlzIHJlYWNoZWQuIDEgPSA5MGRlZywgMC41ID0gNDVkZWcsIGV0Yy4uXHJcbiAgICAgICAqIEBwYXJhbSB7Z3lyb3Njb3BlU2FtcGxlc30gc2V0dGluZ3MuZ3lyb3Njb3BlU2FtcGxlcyAtIEhvdyBtYW55IGd5cm9zY29wZSBtb3ZlcyB0byBkZWNpZGUgdGhlIHN0YXJ0aW5nIHBvc2l0aW9uLlxyXG4gICAgICAgKi9cclxuICAgICAgZXh0ZW5kU2V0dGluZ3Moc2V0dGluZ3MpIHtcclxuICAgICAgICBsZXQgZGVmYXVsdFNldHRpbmdzID0ge1xyXG4gICAgICAgICAgcmV2ZXJzZTogZmFsc2UsXHJcbiAgICAgICAgICBtYXg6IDE1LFxyXG4gICAgICAgICAgc3RhcnRYOiAwLFxyXG4gICAgICAgICAgc3RhcnRZOiAwLFxyXG4gICAgICAgICAgcGVyc3BlY3RpdmU6IDEwMDAsXHJcbiAgICAgICAgICBlYXNpbmc6IFwiY3ViaWMtYmV6aWVyKC4wMywuOTgsLjUyLC45OSlcIixcclxuICAgICAgICAgIHNjYWxlOiAxLFxyXG4gICAgICAgICAgc3BlZWQ6IDMwMCxcclxuICAgICAgICAgIHRyYW5zaXRpb246IHRydWUsXHJcbiAgICAgICAgICBheGlzOiBudWxsLFxyXG4gICAgICAgICAgZ2xhcmU6IGZhbHNlLFxyXG4gICAgICAgICAgXCJtYXgtZ2xhcmVcIjogMSxcclxuICAgICAgICAgIFwiZ2xhcmUtcHJlcmVuZGVyXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJmdWxsLXBhZ2UtbGlzdGVuaW5nXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJtb3VzZS1ldmVudC1lbGVtZW50XCI6IG51bGwsXHJcbiAgICAgICAgICByZXNldDogdHJ1ZSxcclxuICAgICAgICAgIFwicmVzZXQtdG8tc3RhcnRcIjogdHJ1ZSxcclxuICAgICAgICAgIGd5cm9zY29wZTogdHJ1ZSxcclxuICAgICAgICAgIGd5cm9zY29wZU1pbkFuZ2xlWDogLTQ1LFxyXG4gICAgICAgICAgZ3lyb3Njb3BlTWF4QW5nbGVYOiA0NSxcclxuICAgICAgICAgIGd5cm9zY29wZU1pbkFuZ2xlWTogLTQ1LFxyXG4gICAgICAgICAgZ3lyb3Njb3BlTWF4QW5nbGVZOiA0NSxcclxuICAgICAgICAgIGd5cm9zY29wZVNhbXBsZXM6IDEwXHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIGxldCBuZXdTZXR0aW5ncyA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIGRlZmF1bHRTZXR0aW5ncykge1xyXG4gICAgICAgICAgaWYgKHByb3BlcnR5IGluIHNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIG5ld1NldHRpbmdzW3Byb3BlcnR5XSA9IHNldHRpbmdzW3Byb3BlcnR5XTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50Lmhhc0F0dHJpYnV0ZShcImRhdGEtdGlsdC1cIiArIHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICBsZXQgYXR0cmlidXRlID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdGlsdC1cIiArIHByb3BlcnR5KTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICBuZXdTZXR0aW5nc1twcm9wZXJ0eV0gPSBKU09OLnBhcnNlKGF0dHJpYnV0ZSk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICBuZXdTZXR0aW5nc1twcm9wZXJ0eV0gPSBhdHRyaWJ1dGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbmV3U2V0dGluZ3NbcHJvcGVydHldID0gZGVmYXVsdFNldHRpbmdzW3Byb3BlcnR5XTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gbmV3U2V0dGluZ3M7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICBzdGF0aWMgaW5pdChlbGVtZW50cywgc2V0dGluZ3MpIHtcclxuICAgICAgICBpZiAoZWxlbWVudHMgaW5zdGFuY2VvZiBOb2RlKSB7XHJcbiAgICAgICAgICBlbGVtZW50cyA9IFtlbGVtZW50c107XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgaWYgKGVsZW1lbnRzIGluc3RhbmNlb2YgTm9kZUxpc3QpIHtcclxuICAgICAgICAgIGVsZW1lbnRzID0gW10uc2xpY2UuY2FsbChlbGVtZW50cyk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgaWYgKCEoZWxlbWVudHMgaW5zdGFuY2VvZiBBcnJheSkpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICBpZiAoIShcInZhbmlsbGFUaWx0XCIgaW4gZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgZWxlbWVudC52YW5pbGxhVGlsdCA9IG5ldyBWYW5pbGxhVGlsdChlbGVtZW50LCBzZXR0aW5ncyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAvKiBleHBvc2UgdGhlIGNsYXNzIHRvIHdpbmRvdyAqL1xyXG4gICAgICB3aW5kb3cuVmFuaWxsYVRpbHQgPSBWYW5pbGxhVGlsdDtcclxuICAgIFxyXG4gICAgICAvKipcclxuICAgICAgICogQXV0byBsb2FkXHJcbiAgICAgICAqL1xyXG4gICAgICBWYW5pbGxhVGlsdC5pbml0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS10aWx0XVwiKSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBWYW5pbGxhVGlsdDtcclxuICAgIFxyXG4gICAgfSgpKTsiXX0=
